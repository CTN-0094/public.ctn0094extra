<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="public.ctn0094extra">
<title>Summarizing Longitudinal Substance Use as Quinary Words • public.ctn0094extra</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Summarizing Longitudinal Substance Use as Quinary Words">
<meta property="og:description" content="public.ctn0094extra">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">public.ctn0094extra</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.3</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-vignettes">Vignettes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-vignettes">
    <a class="dropdown-item" href="../articles/summarizing_substance_use.html">Summarizing Substance Use</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/CTN-0094/public.ctn0094extra/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Summarizing Longitudinal Substance Use as Quinary Words</h1>
                        <h4 data-toc-skip class="author">Gabriel Odom
and Raymond Balise</h4>
            
            <h4 data-toc-skip class="date">2023-11-14</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/CTN-0094/public.ctn0094extra/blob/HEAD/vignettes/summarizing_substance_use.Rmd" class="external-link"><code>vignettes/summarizing_substance_use.Rmd</code></a></small>
      <div class="d-none name"><code>summarizing_substance_use.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>Here are the packages we need for this vignette:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ctn-0094.github.io/public.ctn0094data/" class="external-link">public.ctn0094data</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ctn-0094.github.io/public.ctn0094extra/">public.ctn0094extra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/" class="external-link">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tibble.tidyverse.org/" class="external-link">tibble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org" class="external-link">tidyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span></span></code></pre></div>
<p>In this vignette, we will walk through the basic procedures to
collapse participants’ Urine Drug Screen (UDS) or Timeline Follow-Back
(TLFB) data streams into <a href="https://doi.org/10.1371/journal.pone.0291248" class="external-link">quinary word</a>
summaries for downstream analysis. The basic steps are:</p>
<ol style="list-style-type: decimal">
<li>calculate the <em>induction</em> delay (difference, in days, between
the day a participant was randomized to a trial arm and the day that
they received the first dose of study drug). The
<code>public.ctn0094data</code> database has a) the day of randomization
and b) the days for which study drugs were administered, relative to Day
0 (the day study consent was signed).</li>
<li>partition the study days into weeks, then mark which weeks do not
have a UDS collection event (these will be marked as “missing”).</li>
<li>summarize the UDS data within each participant by week into symbols
using <a href="https://doi.org/10.1371/journal.pone.0291248" class="external-link">quinary
word logic</a>, then collapse the symbols into a participant-specific
“word”.</li>
</ol>
<p>Rather than perform these calculations on all ~3600 participants
included in <code>public.ctn0094data</code> and
<code>public.ctn0094extra</code>, we will use the following 10
participants as examples:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">examplePeople_int</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1L</span>, <span class="fl">163L</span>, <span class="fl">210L</span>, <span class="fl">242L</span>, <span class="fl">4L</span>, <span class="fl">17L</span>, <span class="fl">13L</span>, <span class="fl">1103L</span>, <span class="fl">233L</span>, <span class="fl">2089L</span><span class="op">)</span></span></code></pre></div>
<hr>
<p></p>
</div>
<div class="section level2">
<h2 id="calculate-induction-delay">Calculate Induction Delay<a class="anchor" aria-label="anchor" href="#calculate-induction-delay"></a>
</h2>
<p>As we mentioned above, the <em>induction</em> delay is the
difference, in days, between the day a participant was randomized to a
trial arm and the day that they received the first dose of study drug.
The reason we need this is because any UDS collected or TLFB recorded on
or before the induction day must be considered <em>pre-treatment</em>,
even if the participant has already been assigned to a treatment
arm.</p>
<div class="section level3">
<h3 id="data-setup">Data Setup<a class="anchor" aria-label="anchor" href="#data-setup"></a>
</h3>
<p>The <code>randomization</code> day includes a first and second
randomization day for all participants. For CTN-0027 and CTN-0051, these
days are the same; for CTN-0030 these days are different. In order to
find the induction delay, we only need the first randomization event</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/loadRawData.html">loadRawData</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"randomization"</span>, <span class="st">"treatment"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_ls</span><span class="op">$</span><span class="va">randomization</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">data_ls</span><span class="op">$</span><span class="va">randomization</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">who</span>, <span class="va">when</span>, <span class="va">treatment</span>, randomized <span class="op">=</span> <span class="va">which</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Remove second randomization events</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">randomized</span> <span class="op">!=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="co"># Retain example participants</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">who</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">examplePeople_int</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_ls</span><span class="op">$</span><span class="va">treatment</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">data_ls</span><span class="op">$</span><span class="va">treatment</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="co"># Retain example participants</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">who</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">examplePeople_int</span><span class="op">)</span></span></code></pre></div>
<p>Let’s inspect our results:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_ls</span><span class="op">$</span><span class="va">randomization</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 9 × 4</span></span></span>
<span><span class="co">#&gt;     who  when treatment            randomized</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     4     1 Inpatient NR-NTX     1         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>    13     4 Outpatient BUP       1         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>    17    13 Methadone            1         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>   163     6 Outpatient BUP       1         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>   210     5 Methadone            1         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>   233     4 Outpatient BUP       1         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span>   242     8 Inpatient NR-NTX     1         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span>  <span style="text-decoration: underline;">1</span>103     4 Outpatient BUP + EMM 1         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">9</span>  <span style="text-decoration: underline;">2</span>089     2 Outpatient BUP       1</span></span>
<span></span>
<span><span class="va">data_ls</span><span class="op">$</span><span class="va">treatment</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,008 × 3</span></span></span>
<span><span class="co">#&gt;      who amount  when</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     4      1     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     4      1    28</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     4      1    53</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     4      1    81</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     4      1   109</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     4      1   141</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>    13      8     4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>    13     12     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>    13     16     6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    13     16     7</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 998 more rows</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="mark-study-days-with-administered-treatment-drugs">Mark Study Days with Administered Treatment Drugs<a class="anchor" aria-label="anchor" href="#mark-study-days-with-administered-treatment-drugs"></a>
</h3>
<p>Some participants were marked as receiving 0mg of the study drug to
which they were assigned. We want to mark all the days where a
participant actually got some of the assigned study drug.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">treatTimeLong_df</span> <span class="op">&lt;-</span></span>
<span>  <span class="co"># Collapse Data List</span></span>
<span>  <span class="va">data_ls</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/reduce.html" class="external-link">reduce</a></span><span class="op">(</span>.f <span class="op">=</span> <span class="va">full_join</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"who"</span>, <span class="st">"when"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html" class="external-link">as_tibble</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">who</span>, <span class="va">when</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># First pass: find any day with a dose of treatment drug</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rowwise.html" class="external-link">rowwise</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    treated <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span></span>
<span>      condition <span class="op">=</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">amount</span><span class="op">)</span> <span class="op">&amp;</span> <span class="va">amount</span> <span class="op">&gt;</span> <span class="fl">0</span>,</span>
<span>      true <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>      false <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>      missing <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="co"># Inspect results</span></span>
<span><span class="va">treatTimeLong_df</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,009 × 6</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Rowwise: </span></span></span>
<span><span class="co">#&gt;      who  when treatment        randomized amount treated</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     4     1 Inpatient NR-NTX 1               1 TRUE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     4    28 <span style="color: #BB0000;">NA</span>               <span style="color: #BB0000;">NA</span>              1 TRUE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     4    53 <span style="color: #BB0000;">NA</span>               <span style="color: #BB0000;">NA</span>              1 TRUE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     4    81 <span style="color: #BB0000;">NA</span>               <span style="color: #BB0000;">NA</span>              1 TRUE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     4   109 <span style="color: #BB0000;">NA</span>               <span style="color: #BB0000;">NA</span>              1 TRUE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     4   141 <span style="color: #BB0000;">NA</span>               <span style="color: #BB0000;">NA</span>              1 TRUE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>    13     4 Outpatient BUP   1               8 TRUE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>    13     5 <span style="color: #BB0000;">NA</span>               <span style="color: #BB0000;">NA</span>             12 TRUE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>    13     6 <span style="color: #BB0000;">NA</span>               <span style="color: #BB0000;">NA</span>             16 TRUE   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    13     7 <span style="color: #BB0000;">NA</span>               <span style="color: #BB0000;">NA</span>             16 TRUE   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 999 more rows</span></span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="measure-difference-from-randomization-day-to-day-of-first-dose">Measure Difference from Randomization Day to Day of First Dose<a class="anchor" aria-label="anchor" href="#measure-difference-from-randomization-day-to-day-of-first-dose"></a>
</h3>
<p>Some participants received their first non-zero dose of their
assigned study drug days after they were assigned to a treatment arm. If
the subject supplies a UDS sample positive for substances of interest or
records a substance use event in the TLFB after they were assigned to
treatment but before they received treatment, these should not count
against the efficacy of the study drug. <strong>NOTE: under the “intent
to treat” paradigm, this is not the case. For example, it is challenging
for some patients to start treatment with Naltrexone, so evaluating
treatment efficacy fairly often requires us to include this time after
treatment assignment but before induction.</strong></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inductDelay_df</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">treatTimeLong_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Find the day of the first treatment</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">who</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">when</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">treated</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>treatStart <span class="op">=</span> <span class="va">when</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">who</span>, <span class="va">when</span>, <span class="va">treatStart</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Add the first day back to the original data</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">treatTimeLong_df</span>, <span class="va">.</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"who"</span>, <span class="st">"when"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">who</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/fill.html" class="external-link">fill</a></span><span class="op">(</span><span class="va">treatStart</span>, .direction <span class="op">=</span> <span class="st">"updown"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Calculate the delay</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">randomized</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># This sets time to be missing if the induction was not observed</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>inductDelay <span class="op">=</span> <span class="va">treatStart</span> <span class="op">-</span> <span class="va">when</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">who</span>, <span class="va">treatment</span>, <span class="va">inductDelay</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Inspect results</span></span>
<span><span class="va">inductDelay_df</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 9 × 3</span></span></span>
<span><span class="co">#&gt;     who treatment            inductDelay</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>                      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     4 Inpatient NR-NTX               0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>    13 Outpatient BUP                 0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>    17 Methadone                      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>   163 Outpatient BUP                 0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>   210 Methadone                      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>   233 Outpatient BUP                 0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span>   242 Inpatient NR-NTX               5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span>  <span style="text-decoration: underline;">1</span>103 Outpatient BUP + EMM           0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">9</span>  <span style="text-decoration: underline;">2</span>089 Outpatient BUP                 0</span></span></code></pre></div>
<p>We can see that participant 242 received their first dose of
Inpatient NR-NTX 5 days after they were assigned to that treatment
arm.</p>
<p>Let’s clean up our environment before we move on:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">data_ls</span>, <span class="va">treatTimeLong_df</span><span class="op">)</span></span></code></pre></div>
<hr>
<p></p>
</div>
</div>
<div class="section level2">
<h2 id="partition-visit-weeks-and-impute-missing-visits">Partition Visit Weeks and Impute Missing Visits<a class="anchor" aria-label="anchor" href="#partition-visit-weeks-and-impute-missing-visits"></a>
</h2>
<p>Now that we have the study day for which each participant received
their first dose of study drug (induction day), we can partition the
study days into weeks before and after induction delay as pre-study /
baseline period and study period, respectively.</p>
<div class="section level3">
<h3 id="backbone-timeline-of-clinical-protocol">“Backbone” Timeline of Clinical Protocol<a class="anchor" aria-label="anchor" href="#backbone-timeline-of-clinical-protocol"></a>
</h3>
<p>If we want to know which visits were missed, we first need to know
which visits were required by the protocols of the three studies.</p>
<div class="section level4">
<h4 id="ctn-0027-and-ctn-0051-protocols">CTN-0027 and CTN-0051 Protocols<a class="anchor" aria-label="anchor" href="#ctn-0027-and-ctn-0051-protocols"></a>
</h4>
<p>This code will create a table with the subject ID, which trial they
participated in, and a column of all possible trial contact days, from
30 days prior to consent to 24 weeks after. See the function
documentation for <code><a href="../reference/CreateProtocolHistory.html">CreateProtocolHistory()</a></code> for more
information.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">start_int</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>`27` <span class="op">=</span> <span class="op">-</span><span class="fl">30L</span>, `51` <span class="op">=</span> <span class="op">-</span><span class="fl">30L</span><span class="op">)</span></span>
<span><span class="va">end_int</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>`27` <span class="op">=</span> <span class="fl">168L</span>, `51` <span class="op">=</span> <span class="fl">168L</span><span class="op">)</span></span>
<span><span class="va">backbone2751_df</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="../reference/CreateProtocolHistory.html">CreateProtocolHistory</a></span><span class="op">(</span></span>
<span>      start_vec <span class="op">=</span> <span class="va">start_int</span>,</span>
<span>      end_vec <span class="op">=</span> <span class="va">end_int</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">who</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">examplePeople_int</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Inspect</span></span>
<span> <span class="va">backbone2751_df</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,592 × 3</span></span></span>
<span><span class="co">#&gt;      who project  when</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>    13 27        -<span style="color: #BB0000;">30</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>    13 27        -<span style="color: #BB0000;">29</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>    13 27        -<span style="color: #BB0000;">28</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>    13 27        -<span style="color: #BB0000;">27</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>    13 27        -<span style="color: #BB0000;">26</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>    13 27        -<span style="color: #BB0000;">25</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>    13 27        -<span style="color: #BB0000;">24</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>    13 27        -<span style="color: #BB0000;">23</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>    13 27        -<span style="color: #BB0000;">22</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    13 27        -<span style="color: #BB0000;">21</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1,582 more rows</span></span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="ctn-0030-protocol">CTN-0030 Protocol<a class="anchor" aria-label="anchor" href="#ctn-0030-protocol"></a>
</h4>
<p>Because the CTN-0030 protocol was adaptive, the amount of time
requested to be spent in the study will change based on the
participants’ reactions to the first phase of treatment. See the
function documentation for <code><a href="../reference/CreateCTN30ProtocolHistory.html">CreateCTN30ProtocolHistory()</a></code> for
more information.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">backbone30_df</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">randomization</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">everybody</span>, by <span class="op">=</span> <span class="st">"who"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">project</span> <span class="op">==</span> <span class="st">"30"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">who</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">examplePeople_int</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="../reference/CreateCTN30ProtocolHistory.html">CreateCTN30ProtocolHistory</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>project <span class="op">=</span> <span class="st">"30"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">who</span>, <span class="va">project</span>, <span class="va">when</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Inspect</span></span>
<span><span class="va">backbone30_df</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 402 × 3</span></span></span>
<span><span class="co">#&gt;      who project  when</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1 30        -<span style="color: #BB0000;">30</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     1 30        -<span style="color: #BB0000;">29</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     1 30        -<span style="color: #BB0000;">28</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     1 30        -<span style="color: #BB0000;">27</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     1 30        -<span style="color: #BB0000;">26</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     1 30        -<span style="color: #BB0000;">25</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     1 30        -<span style="color: #BB0000;">24</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     1 30        -<span style="color: #BB0000;">23</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     1 30        -<span style="color: #BB0000;">22</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     1 30        -<span style="color: #BB0000;">21</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 392 more rows</span></span></span>
<span></span>
<span><span class="va">backbone30_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">who</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>lastDay <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">when</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 2</span></span></span>
<span><span class="co">#&gt;     who lastDay</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1      98</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>  <span style="text-decoration: underline;">1</span>103     242</span></span></code></pre></div>
<p>We can clearly see that the protocol length for some participants in
CTN-0030 was much longer than others.</p>
</div>
<div class="section level4">
<h4 id="combined-backbone">Combined “Backbone”<a class="anchor" aria-label="anchor" href="#combined-backbone"></a>
</h4>
<p>We can now combine these two datasets and clean up our
environment.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">backbone_df</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">backbone2751_df</span>, <span class="va">backbone30_df</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">who</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">backbone2751_df</span>, <span class="va">backbone30_df</span>, <span class="va">start_int</span>, <span class="va">end_int</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="mark-missing-visits">Mark Missing Visits<a class="anchor" aria-label="anchor" href="#mark-missing-visits"></a>
</h3>
<p>Now that we know the start of treatment and range of expected
participation days per protocol, we can take the “difference” to find
out when participants were supposed to visit the clinic, but did
not.</p>
<div class="section level4">
<h4 id="data-setup-1">Data Setup<a class="anchor" aria-label="anchor" href="#data-setup-1"></a>
</h4>
<p>Let’s set up the data for our example people:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data_ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/loadRawData.html">loadRawData</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"randomization"</span>, <span class="st">"visit"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_ls</span><span class="op">$</span><span class="va">randomization</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">data_ls</span><span class="op">$</span><span class="va">randomization</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">who</span>, <span class="va">when</span>, <span class="va">treatment</span>, randomized <span class="op">=</span> <span class="va">which</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Remove second randomization events</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">randomized</span> <span class="op">!=</span> <span class="fl">2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="co"># Retain example participants</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">who</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">examplePeople_int</span><span class="op">)</span></span>
<span></span>
<span><span class="va">data_ls</span><span class="op">$</span><span class="va">visit</span> <span class="op">&lt;-</span> </span>
<span>  <span class="va">data_ls</span><span class="op">$</span><span class="va">visit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">who</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">examplePeople_int</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="add-first-randomization-day">Add First Randomization Day<a class="anchor" aria-label="anchor" href="#add-first-randomization-day"></a>
</h4>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">timelineRand1_df</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">data_ls</span><span class="op">$</span><span class="va">randomization</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>randomized <span class="op">=</span> <span class="va">randomized</span> <span class="op">==</span> <span class="st">"1"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="co"># Join to backbone and arrange within subject by day</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">backbone_df</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"who"</span>, <span class="st">"when"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">who</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">when</span>, .by_group <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">who</span>, <span class="va">project</span>, <span class="va">when</span>, <span class="va">randomized</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Inspect</span></span>
<span><span class="va">timelineRand1_df</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,994 × 4</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   who [10]</span></span></span>
<span><span class="co">#&gt;      who project  when randomized</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1 30        -<span style="color: #BB0000;">30</span> <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     1 30        -<span style="color: #BB0000;">29</span> <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     1 30        -<span style="color: #BB0000;">28</span> <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     1 30        -<span style="color: #BB0000;">27</span> <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     1 30        -<span style="color: #BB0000;">26</span> <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     1 30        -<span style="color: #BB0000;">25</span> <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     1 30        -<span style="color: #BB0000;">24</span> <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     1 30        -<span style="color: #BB0000;">23</span> <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     1 30        -<span style="color: #BB0000;">22</span> <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     1 30        -<span style="color: #BB0000;">21</span> <span style="color: #BB0000;">NA</span>        </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1,984 more rows</span></span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="add-on-the-visit-days">Add on the Visit Days<a class="anchor" aria-label="anchor" href="#add-on-the-visit-days"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">timelineVisit1_df</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">data_ls</span><span class="op">$</span><span class="va">visit</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">who</span>, <span class="va">when</span>, <span class="va">visit</span>, status <span class="op">=</span> <span class="va">what</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">status</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"visit"</span>, <span class="st">"final"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>visit <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">who</span>, <span class="va">when</span>, <span class="va">visit</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">timelineRand1_df</span>, <span class="va">.</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"who"</span>, <span class="st">"when"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Inspect</span></span>
<span><span class="va">timelineVisit1_df</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,994 × 5</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   who [10]</span></span></span>
<span><span class="co">#&gt;      who project  when randomized visit</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1 30        -<span style="color: #BB0000;">30</span> <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     1 30        -<span style="color: #BB0000;">29</span> <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     1 30        -<span style="color: #BB0000;">28</span> <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     1 30        -<span style="color: #BB0000;">27</span> <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     1 30        -<span style="color: #BB0000;">26</span> <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     1 30        -<span style="color: #BB0000;">25</span> <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     1 30        -<span style="color: #BB0000;">24</span> <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     1 30        -<span style="color: #BB0000;">23</span> <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     1 30        -<span style="color: #BB0000;">22</span> <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     1 30        -<span style="color: #BB0000;">21</span> <span style="color: #BB0000;">NA</span>         <span style="color: #BB0000;">NA</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 1,984 more rows</span></span></span></code></pre></div>
<p>Most (6 of 7 days, on average) of the data will be missing values
(shown by <code>NA</code>) because participants were not expected to
visit the clinic more than once per week.</p>
</div>
<div class="section level4">
<h4 id="impute-the-missing-visits">Impute the Missing Visits<a class="anchor" aria-label="anchor" href="#impute-the-missing-visits"></a>
</h4>
<p>This function will assign visit values to “missing” roughly every
seven days that a visit hasn’t been recorded. See the function
documentation for <code><a href="../reference/MarkMissing.html">MarkMissing()</a></code> for more information.
<em>Note: this function can take a while to run if used on thousands of
participants over dozens of weeks each.</em></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">timelineMissing1_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/MarkMissing.html">MarkMissing</a></span><span class="op">(</span><span class="va">timelineVisit1_df</span><span class="op">)</span> </span></code></pre></div>
</div>
<div class="section level4">
<h4 id="clean-up-the-results">Clean up the Results<a class="anchor" aria-label="anchor" href="#clean-up-the-results"></a>
</h4>
<p>We aren’t showing the results from the function above because they
still need to be wrangled a bit.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">derived_visitImputed</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">timelineMissing1_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>visit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">visit</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/replace_na.html" class="external-link">replace_na</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>visit <span class="op">=</span> <span class="st">""</span>, visitYM <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>visitImputed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">visit</span>, <span class="va">visitYM</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        visitImputed <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html" class="external-link">str_replace</a></span><span class="op">(</span></span>
<span>            <span class="va">visitImputed</span>, pattern <span class="op">=</span> <span class="st">"TRUETRUE"</span>, replacement <span class="op">=</span> <span class="st">"Present"</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">who</span>, <span class="va">when</span>, <span class="va">visitImputed</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">visitImputed</span> <span class="op">!=</span> <span class="st">""</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Inspect</span></span>
<span><span class="va">derived_visitImputed</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 256 × 3</span></span></span>
<span><span class="co">#&gt;      who  when visitImputed</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1     0 Missing     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     1     7 Missing     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     1    14 Missing     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     1    21 Missing     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     1    28 Missing     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     1    35 Missing     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     1    42 Missing     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     1    49 Missing     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     1    56 Missing     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     1    63 Missing     </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 246 more rows</span></span></span></code></pre></div>
<p>Let’s now clean up our environment:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span></span>
<span>  <span class="va">backbone_df</span>, <span class="va">data_ls</span>, <span class="va">timelineMissing1_df</span>, <span class="va">timelineRand1_df</span>, <span class="va">timelineVisit1_df</span></span>
<span><span class="op">)</span></span></code></pre></div>
<hr>
<p></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="summarize-weekly-substance-use-results">Summarize Weekly Substance Use Results<a class="anchor" aria-label="anchor" href="#summarize-weekly-substance-use-results"></a>
</h2>
<p>This step is the most involved, so we will only show the steps
necessary to complete this task for our 10 example participants.
However, the full workflow is available at <link>. The general steps for
randomized trial participants in this procedure are:</p>
<ol style="list-style-type: decimal">
<li>Determine which treatment arm to which each participant was
assigned. Recall that buprenorphine can be used both as a standard
treatment and an illicit substance. Therefore, having a TLFB record of
or UDS positive for buprenorphine for a particular study day should not
automatically be counted as “substance misuse”.</li>
<li>For the substance(s) of interest (in our case, opioids), indicate
their presence (or absence) in participants’ data streams for each study
visit day. This will result in a “long” data table with one row per
participant per study visit and a logical value indicating if the
participant used the substance(s) of interest on that day.</li>
<li>Create a “ticker” of study days, then partition these days into
study weeks. For an “intent to treat” analysis, day 0 should be the
randomization day. Otherwise, day 0 should be the induction day
calculated above. <em>Note: we will use an “intent to treat” analysis
from this point on.</em>
</li>
<li>Summarize substance use within each study week using a <a href="https://doi.org/10.1371/journal.pone.0291248" class="external-link">quinary word</a>.
For many participants, they have at least one week wherein more than one
UDS sample was supplied. Our combination logic to summarize detected
weekly substance use is as follows: if all UDS samples within that study
week are positive for the substance(s) of interest, then the week is
marked “+”. If all UDS samples are negative for the substance(s) of
interest, then the week is marked “-”. If there is a mixture, the week
is marked “*”. If the participant was supposed to supply a urine sample
in that week but did not, then the week is marked “o”. If the
participant was not supposed to supply a urine sample in that week (and
did not supply one), then the week is marked “_”.</li>
<li>Group these weekly summaries into trial phase (baseline /
pre-randomization, phase 1, or phase 2 [CTN-0030 only]) and collapse
into a single string.</li>
</ol>
<p>You may have participants who consented to join the trial but were
never randomized to a treatment arm. For these individuals, if a
“complete study summary” is required (that is, you must include all
participants who consented, even if they never were randomized), we
recommend creating a use pattern word which is either all “o” or all
“_”.</p>
<div class="section level3">
<h3 id="data-setup-2">Data Setup<a class="anchor" aria-label="anchor" href="#data-setup-2"></a>
</h3>
<p>First we build our data “backbone” as above (showing here to mirror
the work done in the analysis script):</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># CTN-0027 and CTN-0051</span></span>
<span><span class="va">start_int</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>`27` <span class="op">=</span> <span class="op">-</span><span class="fl">30L</span>, `51` <span class="op">=</span> <span class="op">-</span><span class="fl">30L</span><span class="op">)</span></span>
<span><span class="va">end_int</span>   <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>`27` <span class="op">=</span> <span class="fl">168L</span>, `51` <span class="op">=</span> <span class="fl">168L</span><span class="op">)</span> <span class="co"># 24 weeks</span></span>
<span><span class="va">backbone2751_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/CreateProtocolHistory.html">CreateProtocolHistory</a></span><span class="op">(</span></span>
<span>    start_vec <span class="op">=</span> <span class="va">start_int</span>, end_vec <span class="op">=</span> <span class="va">end_int</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># CTN-0030</span></span>
<span><span class="va">backbone30_df</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">randomization</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">everybody</span>, by <span class="op">=</span> <span class="st">"who"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">project</span> <span class="op">==</span> <span class="st">"30"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/CreateCTN30ProtocolHistory.html">CreateCTN30ProtocolHistory</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>project <span class="op">=</span> <span class="st">"30"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">who</span>, <span class="va">project</span>, <span class="va">when</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># All Days</span></span>
<span><span class="va">backbone_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span></span>
<span>    <span class="va">backbone2751_df</span>, <span class="va">backbone30_df</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">who</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>project <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">project</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"27"</span>, <span class="st">"30"</span>, <span class="st">"51"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">who</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">examplePeople_int</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">backbone2751_df</span>, <span class="va">backbone30_df</span>, <span class="va">start_int</span>, <span class="va">end_int</span><span class="op">)</span></span></code></pre></div>
<p>Now we create a data set that combines the treatment arm with the
imputed visits data we calculated above.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">randomized_df</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">randomization</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">who</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">examplePeople_int</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>randomized <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">which</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">who</span>, <span class="va">when</span>, <span class="va">randomized</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">everybody</span>, by <span class="op">=</span> <span class="st">"who"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span> <span class="op">!</span><span class="op">(</span><span class="va">randomized</span> <span class="op">==</span> <span class="fl">2</span> <span class="op">&amp;</span> <span class="va">project</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"27"</span>, <span class="st">"51"</span><span class="op">)</span><span class="op">)</span> <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">project</span><span class="op">)</span></span>
<span></span>
<span><span class="va">udsUse2_df</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">backbone_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">randomized_df</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"who"</span>, <span class="st">"when"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">derived_visitImputed</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"who"</span>, <span class="st">"when"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">uds</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"who"</span>, <span class="st">"when"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="co"># So we can use MarkUse() with UDS data (instead of all_drugs)</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>source <span class="op">=</span> <span class="st">"UDS"</span><span class="op">)</span></span></code></pre></div>
<p>This data set is an interesting one. It has one record per
participant, per study day, <em>per substance reported</em>. So, because
we are using UDS, this means that only rows which correspond to
<em>study visit days</em> wherein a urine sample was supplied and
positive for multiple substances will be duplicated. If we had used TLFB
data instead, a data table in this form would be orders of magnitude
longer, with many rows per participant per day. Here are visit days
wherein substances were detected in the urine of participant 0017:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">udsUse2_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">visitImputed</span> <span class="op">==</span> <span class="st">"Present"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">what</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">who</span> <span class="op">==</span> <span class="fl">17</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 41 × 7</span></span></span>
<span><span class="co">#&gt;      who project  when randomized visitImputed what           source</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>    17 27          0         <span style="color: #BB0000;">NA</span> Present      Amphetamine    UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>    17 27          0         <span style="color: #BB0000;">NA</span> Present      Benzodiazepine UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>    17 27          0         <span style="color: #BB0000;">NA</span> Present      Opioid         UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>    17 27         21         <span style="color: #BB0000;">NA</span> Present      Benzodiazepine UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>    17 27         28         <span style="color: #BB0000;">NA</span> Present      Benzodiazepine UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>    17 27         28         <span style="color: #BB0000;">NA</span> Present      Opioid         UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>    17 27         35         <span style="color: #BB0000;">NA</span> Present      Benzodiazepine UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>    17 27         35         <span style="color: #BB0000;">NA</span> Present      Opioid         UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>    17 27         49         <span style="color: #BB0000;">NA</span> Present      Opioid         UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>    17 27         56         <span style="color: #BB0000;">NA</span> Present      Benzodiazepine UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>    17 27         56         <span style="color: #BB0000;">NA</span> Present      Cocaine        UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>    17 27         56         <span style="color: #BB0000;">NA</span> Present      Opioid         UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>    17 27         63         <span style="color: #BB0000;">NA</span> Present      Benzodiazepine UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>    17 27         63         <span style="color: #BB0000;">NA</span> Present      Cocaine        UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>    17 27         63         <span style="color: #BB0000;">NA</span> Present      Opioid         UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span>    17 27         63         <span style="color: #BB0000;">NA</span> Present      Thc            UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span>    17 27         72         <span style="color: #BB0000;">NA</span> Present      Benzodiazepine UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span>    17 27         72         <span style="color: #BB0000;">NA</span> Present      Opioid         UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span>    17 27         77         <span style="color: #BB0000;">NA</span> Present      Benzodiazepine UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span>    17 27         77         <span style="color: #BB0000;">NA</span> Present      Opioid         UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">21</span>    17 27         84         <span style="color: #BB0000;">NA</span> Present      Opioid         UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">22</span>    17 27         98         <span style="color: #BB0000;">NA</span> Present      Opioid         UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">23</span>    17 27        105         <span style="color: #BB0000;">NA</span> Present      Opioid         UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">24</span>    17 27        112         <span style="color: #BB0000;">NA</span> Present      Benzodiazepine UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">25</span>    17 27        112         <span style="color: #BB0000;">NA</span> Present      Cocaine        UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">26</span>    17 27        112         <span style="color: #BB0000;">NA</span> Present      Opioid         UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">27</span>    17 27        112         <span style="color: #BB0000;">NA</span> Present      Thc            UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">28</span>    17 27        119         <span style="color: #BB0000;">NA</span> Present      Benzodiazepine UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">29</span>    17 27        119         <span style="color: #BB0000;">NA</span> Present      Opioid         UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">30</span>    17 27        126         <span style="color: #BB0000;">NA</span> Present      Amphetamine    UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">31</span>    17 27        126         <span style="color: #BB0000;">NA</span> Present      Benzodiazepine UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">32</span>    17 27        126         <span style="color: #BB0000;">NA</span> Present      Opioid         UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">33</span>    17 27        133         <span style="color: #BB0000;">NA</span> Present      Benzodiazepine UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">34</span>    17 27        133         <span style="color: #BB0000;">NA</span> Present      Opioid         UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">35</span>    17 27        147         <span style="color: #BB0000;">NA</span> Present      Benzodiazepine UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">36</span>    17 27        147         <span style="color: #BB0000;">NA</span> Present      Opioid         UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">37</span>    17 27        156         <span style="color: #BB0000;">NA</span> Present      Benzodiazepine UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">38</span>    17 27        156         <span style="color: #BB0000;">NA</span> Present      Opioid         UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">39</span>    17 27        156         <span style="color: #BB0000;">NA</span> Present      Thc            UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">40</span>    17 27        161         <span style="color: #BB0000;">NA</span> Present      Benzodiazepine UDS   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">41</span>    17 27        161         <span style="color: #BB0000;">NA</span> Present      Opioid         UDS</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="participants-assigned-treatment">Participant’s Assigned Treatment<a class="anchor" aria-label="anchor" href="#participants-assigned-treatment"></a>
</h3>
<p>Which substances are considered “approved” and which are
“illicit”?</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nonStudyOpioids_ls</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"Buprenorphine"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Opioid"</span>, <span class="st">"Methadone"</span><span class="op">)</span>,</span>
<span>  <span class="st">"Methadone"</span>     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Opioid"</span>, <span class="st">"Buprenorphine"</span><span class="op">)</span>,</span>
<span>  <span class="st">"Naltrexone"</span>    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Opioid"</span>, <span class="st">"Methadone"</span>, <span class="st">"Buprenorphine"</span><span class="op">)</span>,</span>
<span>  <span class="st">"Not treated"</span>   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Opioid"</span>, <span class="st">"Methadone"</span>, <span class="st">"Buprenorphine"</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Now we extract the treatment groups for each clinical trial, so that
we can mark “illicit” buprenorphine and methadone appropriately.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">treatGroups_ls</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">public.ctn0094data</span><span class="fu">::</span><span class="va"><a href="https://ctn-0094.github.io/public.ctn0094data/reference/randomization.html" class="external-link">randomization</a></span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">who</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">examplePeople_int</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">which</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">everybody</span>, by <span class="op">=</span> <span class="st">"who"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">who</span>, <span class="va">treatment</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    treat_drug <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">treatment</span>, <span class="st">"BUP"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"Buprenorphine"</span>,</span>
<span>      <span class="va">treatment</span> <span class="op">==</span> <span class="st">"Methadone"</span> <span class="op">~</span> <span class="st">"Methadone"</span>,</span>
<span>      <span class="va">treatment</span> <span class="op">==</span> <span class="st">"Inpatient NR-NTX"</span> <span class="op">~</span> <span class="st">"Naltrexone"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">treatment</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span>f <span class="op">=</span> <span class="va">.</span><span class="op">$</span><span class="va">treat_drug</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span>.f <span class="op">=</span> <span class="st">"who"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Inspect</span></span>
<span><span class="va">treatGroups_ls</span></span>
<span><span class="co">#&gt; $Buprenorphine</span></span>
<span><span class="co">#&gt; [1]   13  163  233 1103 2089</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Methadone</span></span>
<span><span class="co">#&gt; [1]  17 210</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $Naltrexone</span></span>
<span><span class="co">#&gt; [1]   4 242</span></span></code></pre></div>
<p>This shows us which participants were assigned to buprenorphine,
methadone, and naltrexone, respectively. We can now compare the
substances present in urine against the substances the participants are
supposed to have in their urine. For more information, see the
documentation for the <code><a href="../reference/MarkUse.html">MarkUse()</a></code> function.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">opioidUse_df</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">udsUse2_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    treat_group <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">who</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">treatGroups_ls</span><span class="op">$</span><span class="va">Buprenorphine</span> <span class="op">~</span> <span class="st">"Buprenorphine"</span>,</span>
<span>      <span class="va">who</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">treatGroups_ls</span><span class="op">$</span><span class="va">Methadone</span>     <span class="op">~</span> <span class="st">"Methadone"</span>,</span>
<span>      <span class="va">who</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">treatGroups_ls</span><span class="op">$</span><span class="va">Naltrexone</span>    <span class="op">~</span> <span class="st">"Naltrexone"</span>,</span>
<span>      <span class="cn">TRUE</span>                                  <span class="op">~</span> <span class="st">"Not treated"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span>f <span class="op">=</span> <span class="va">.</span><span class="op">$</span><span class="va">treat_group</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># List of data in alphabetical order, so the non-study drugs ls should match</span></span>
<span>  <span class="fu"><a href="https://purrr.tidyverse.org/reference/map2.html" class="external-link">map2</a></span><span class="op">(</span></span>
<span>    .y <span class="op">=</span> <span class="va">nonStudyOpioids_ls</span>,</span>
<span>    .f <span class="op">=</span> <span class="op">~</span><span class="op">{</span></span>
<span>      <span class="co"># REQUIRES "source" COLUMN</span></span>
<span>      <span class="fu"><a href="../reference/MarkUse.html">MarkUse</a></span><span class="op">(</span></span>
<span>        targetDrugs_char <span class="op">=</span> <span class="va">.y</span>,</span>
<span>        drugs_df <span class="op">=</span> <span class="va">.x</span>,</span>
<span>        <span class="co"># because we have participants with no recorded UDS; in practice DO NOT</span></span>
<span>        <span class="co">#   use this command</span></span>
<span>        retainEmptyRows <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>      <span class="op">)</span> </span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    udsOpioid <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">when</span><span class="op">)</span> <span class="op">~</span> <span class="cn">NA</span>,</span>
<span>      <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">when</span><span class="op">)</span> <span class="op">~</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">who</span>, <span class="va">when</span>, <span class="va">udsOpioid</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning: The following drugs were not matched: Methadone. Please check for</span></span>
<span><span class="co">#&gt; possible spelling/capitalization errors.</span></span>
<span><span class="co">#&gt; Warning: The following drugs were not matched: Buprenorphine. Please check for</span></span>
<span><span class="co">#&gt; possible spelling/capitalization errors.</span></span>
<span><span class="co">#&gt; Warning: The following drugs were not matched: Opioid, Methadone. Please check</span></span>
<span><span class="co">#&gt; for possible spelling/capitalization errors.</span></span>
<span><span class="co">#&gt; Warning: No matching drugs found. If you are using the default data set, please</span></span>
<span><span class="co">#&gt;   see the help file for a list of possible drug choices.</span></span></code></pre></div>
<p>All of the drugs marked above would still be individual rows, so we
want to get back to “one row per person per day”</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">timelineUDS_df</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">udsUse2_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">opioidUse_df</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"who"</span>, <span class="st">"when"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">what</span>, <span class="op">-</span><span class="va">source</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># 2,089 rows to 1,994</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span></span>
<span>  <span class="va">derived_visitImputed</span>, <span class="va">opioidUse_df</span>, <span class="va">randomized_df</span>, <span class="va">treatGroups_ls</span>, <span class="va">udsUse2_df</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="counting-days-since-randomization">Counting Days Since Randomization<a class="anchor" aria-label="anchor" href="#counting-days-since-randomization"></a>
</h3>
<p>Do we state that by definition any person who wasn’t randomized is an
early treatment failure? In the sense of evaluating treatment efficacy,
yes; in evaluating the subject, no. Regardless, no matter the treatment
outcome definition, participants without a randomization date will be
listed as treatment failures under the “intent to treat” paradigm.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wasRandomized_int</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">timelineUDS_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">who</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>randomized <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">randomized</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">randomized</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">who</span><span class="op">)</span></span>
<span><span class="va">notRandomized_int</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">timelineUDS_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span> <span class="op">!</span><span class="op">(</span><span class="va">who</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">wasRandomized_int</span><span class="op">)</span> <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/pull.html" class="external-link">pull</a></span><span class="op">(</span><span class="va">who</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Was randomized:</span></span>
<span><span class="va">wasRandomized_int</span></span>
<span><span class="co">#&gt; [1]    4   13   17  163  210  233  242 1103 2089</span></span>
<span></span>
<span><span class="co"># Wasn't</span></span>
<span><span class="va">notRandomized_int</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
<p>Now we need a Study Day ticker (for randomized subjects only). Recall
that CTN-0030 trial participants potentially have 2 randomization
days.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">timelineUDS2_df</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">timelineUDS_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">who</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">wasRandomized_int</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">who</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">randomized</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        whenRandomized1 <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">randomized</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">~</span> <span class="va">when</span><span class="op">)</span>,</span>
<span>        whenRandomized2 <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">randomized</span> <span class="op">==</span> <span class="fl">2</span> <span class="op">~</span> <span class="va">when</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">who</span>, <span class="va">when</span>, <span class="va">whenRandomized1</span>, <span class="va">whenRandomized2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">timelineUDS_df</span>, <span class="va">.</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"who"</span>, <span class="st">"when"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">who</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">wasRandomized_int</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="co"># Add back in the groupings BEFORE the fill()</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">who</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/fill.html" class="external-link">fill</a></span><span class="op">(</span><span class="va">whenRandomized1</span>, .direction <span class="op">=</span> <span class="st">"updown"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://tidyr.tidyverse.org/reference/fill.html" class="external-link">fill</a></span><span class="op">(</span><span class="va">whenRandomized2</span>, .direction <span class="op">=</span> <span class="st">"updown"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>daysSinceRand1 <span class="op">=</span> <span class="va">when</span> <span class="op">-</span> <span class="va">whenRandomized1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>daysSinceRand2 <span class="op">=</span> <span class="va">when</span> <span class="op">-</span> <span class="va">whenRandomized2</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="op">-</span><span class="va">whenRandomized1</span>, <span class="op">-</span><span class="va">whenRandomized2</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="symbolically-summarize-participant-uds-by-study-week">Symbolically Summarize Participant UDS by Study Week<a class="anchor" aria-label="anchor" href="#symbolically-summarize-participant-uds-by-study-week"></a>
</h3>
<p>We puts the first day of “study week 1” on the day after
randomization, not on the day of consent, but consent could have been
signed also on the same day as randomization.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weeklyUse_df</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">timelineUDS2_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># The (daysSinceRand1 - 1) adjustment is to ensure that the first study week</span></span>
<span>  <span class="co">#   is a full 7 days, since "day 0" is the day before randomization. The "+1"</span></span>
<span>  <span class="co">#   at the end is to shift the study week label such that "week 0" is the </span></span>
<span>  <span class="co">#   week *BEFORE* treatment, rather than the first week of treatment. So, the</span></span>
<span>  <span class="co">#   randomization day is the last day of "week 0" (the pre-treatment period).</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>studyWeek1 <span class="op">=</span> <span class="op">(</span><span class="va">daysSinceRand1</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%/%</a></span> <span class="fl">7</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>studyWeek2 <span class="op">=</span> <span class="op">(</span><span class="va">daysSinceRand2</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%/%</a></span> <span class="fl">7</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">who</span>, <span class="va">studyWeek1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># There are some study weeks with multiple UDS, so we count the number of</span></span>
<span>  <span class="co">#   positive and negative UDS per week.</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    nPosUDS  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">udsOpioid</span> <span class="op">==</span> <span class="fl">1</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    nNegUDS  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">visitImputed</span> <span class="op">==</span> <span class="st">"Present"</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">udsOpioid</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    nMissing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">visitImputed</span> <span class="op">==</span> <span class="st">"Missing"</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    randWk1  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">randomized</span> <span class="op">==</span> <span class="fl">1</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span>,</span>
<span>    randWk2  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">randomized</span> <span class="op">==</span> <span class="fl">2</span> <span class="op">&amp;</span> <span class="va">project</span> <span class="op">==</span> <span class="st">"30"</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Now we assign a single symbol to represent the UDS results for each
participant week. The symbols are (+) for only positive UDS, (–) only
negative UDS, (*) at least one of each positive and negative UDS, (o)
UDS required but not collected, or (_) UDS not required.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">useByWeekRandomized_df</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">weeklyUse_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>        udsStatus <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>            <span class="co"># If we see a positive UDS and no negative UDS, it's positive</span></span>
<span>            <span class="va">nPosUDS</span> <span class="op">&gt;</span> <span class="fl">0</span>  <span class="op">&amp;</span> <span class="va">nNegUDS</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"+"</span>,</span>
<span>            <span class="co"># If we see a negative UDS and no positive UDS, it's negative</span></span>
<span>            <span class="va">nPosUDS</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">nNegUDS</span> <span class="op">&gt;</span> <span class="fl">0</span>  <span class="op">~</span> <span class="st">"-"</span>,</span>
<span>            <span class="co"># If we see both positive and negative UDS in a single week, it's both</span></span>
<span>            <span class="co">#   (note that we can recode all "B"s to be "+" as necessary)</span></span>
<span>            <span class="va">nPosUDS</span> <span class="op">&gt;</span> <span class="fl">0</span>  <span class="op">&amp;</span> <span class="va">nNegUDS</span> <span class="op">&gt;</span> <span class="fl">0</span>  <span class="op">~</span> <span class="st">"*"</span>,</span>
<span>            <span class="co"># If we don't have any UDS in a week after randomization, it's missing</span></span>
<span>            <span class="co"># UPDATE 2022-03-08: I had this as a 0 originally, and I was using this</span></span>
<span>            <span class="co">#   in context of consent, not randomization. This was wrong.</span></span>
<span>            <span class="va">nPosUDS</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">nNegUDS</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">studyWeek1</span> <span class="op">&gt;=</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"o"</span>,</span>
<span>            <span class="co"># If none of the above are true, but we still have a missing value as</span></span>
<span>            <span class="co">#   marked by the MarkMissing() function, then it's missing</span></span>
<span>            <span class="va">nMissing</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">~</span> <span class="st">"o"</span>,</span>
<span>            <span class="co"># If none of the above conditions are true (probably because it's a week</span></span>
<span>            <span class="co">#   before randomization but not during a baseline visit for consent),</span></span>
<span>            <span class="co">#   then leave it blank (pre-study)</span></span>
<span>            <span class="cn">TRUE</span> <span class="op">~</span> <span class="st">"_"</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">who</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># For CTN-0030, Phase II could have started on any day of the week, even in</span></span>
<span>  <span class="co">#   the middle of a treatment week. If we try to start counting Phase II</span></span>
<span>  <span class="co">#   weeks the day after treatment arms are switched, we can end up with the</span></span>
<span>  <span class="co">#   last "week" of Phase I not having 7 days. I'm going to leave the first</span></span>
<span>  <span class="co">#   week of Phase II as whatever week the switch happened in.</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    rand1Active <span class="op">=</span> <span class="va">studyWeek1</span> <span class="op">&gt;</span> <span class="fl">0</span>,</span>
<span>    <span class="co"># This returns 0 for any week before the Phase II randomization, and 1 for</span></span>
<span>    <span class="co">#   the Phase II randomization week and all subsequent weeks (because the</span></span>
<span>    <span class="co">#   randWk2 column is 1 only for the week of second randomization and 0 </span></span>
<span>    <span class="co">#   all other rows).</span></span>
<span>    rand2Active <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cumsum.html" class="external-link">cumsum</a></span><span class="op">(</span><span class="va">randWk2</span><span class="op">)</span>,</span>
<span>    trialPhase  <span class="op">=</span> <span class="va">rand1Active</span> <span class="op">+</span> <span class="va">rand2Active</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span></span>
<span>      <span class="va">who</span>, studyWeek <span class="op">=</span> <span class="va">studyWeek1</span>, <span class="va">randWk1</span>, <span class="va">randWk2</span>, <span class="va">udsStatus</span>, <span class="va">trialPhase</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p>We then split these rows by trial phase, and collapse the weekly
symbols into a single string.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weeklyOpioidPatterns_df</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">useByWeekRandomized_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    phase <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">trialPhase</span> <span class="op">==</span> <span class="fl">0L</span> <span class="op">~</span> <span class="st">"Baseline"</span>,</span>
<span>      <span class="va">trialPhase</span> <span class="op">==</span> <span class="fl">1L</span> <span class="op">~</span> <span class="st">"Phase_1"</span>,</span>
<span>      <span class="va">trialPhase</span> <span class="op">==</span> <span class="fl">2L</span> <span class="op">~</span> <span class="st">"Phase_2"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">who</span>, <span class="va">phase</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    usePattern <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">udsStatus</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="st">"phase"</span>, values_from <span class="op">=</span> <span class="st">"usePattern"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">weeklyOpioidPatterns_df</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 9 × 4</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   who [9]</span></span></span>
<span><span class="co">#&gt;     who Baseline Phase_1                  Phase_2                  </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     4 ____-    --------------------o-oo <span style="color: #BB0000;">NA</span>                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>    13 ____*    -------o---o-ooooooooooo <span style="color: #BB0000;">NA</span>                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>    17 _____+-  o-++*++++++-++++++-+++-  <span style="color: #BB0000;">NA</span>                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>   163 _____*   ----oo---o--o*-o-------o <span style="color: #BB0000;">NA</span>                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>   210 _____*   ++++++++-+++-----o-----o <span style="color: #BB0000;">NA</span>                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>   233 ____*    +++++++++++++++++++++++o <span style="color: #BB0000;">NA</span>                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span>   242 ____+_   -----------------------  <span style="color: #BB0000;">NA</span>                       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span>  <span style="text-decoration: underline;">1</span>103 ____+    +o--oo--o                *+-+---o---------o-o-o-o-</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">9</span>  <span style="text-decoration: underline;">2</span>089 ____*    ++++---+---------------- <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
<p>Notice that we have the opioid UDS results for each subject by week
split into the various phases of the clinical trial. These summaries are
in <strong>quinary word</strong> format, following the work in Odom et
al. (2023) [<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC10490938/" class="external-link uri">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC10490938/</a>].</p>
<p>Our last step for the randomized participants is to mark the study
weeks when these phases start and end.</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">derived_weeklyOpioidPatternRand</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">useByWeekRandomized_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    randWeek1  <span class="op">=</span> <span class="va">randWk1</span> <span class="op">*</span> <span class="va">studyWeek</span>,</span>
<span>    randWeek2  <span class="op">=</span> <span class="va">randWk2</span> <span class="op">*</span> <span class="va">studyWeek</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    startWeek  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">studyWeek</span><span class="op">)</span>,</span>
<span>    randWeek1  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">randWeek1</span><span class="op">)</span>,</span>
<span>    randWeek2  <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/if_else.html" class="external-link">if_else</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">randWeek2</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span>, <span class="cn">NA_real_</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">randWeek2</span><span class="op">)</span> <span class="op">)</span>,</span>
<span>    endWeek    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">studyWeek</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># View this smaller data set before joining. In practice, you can comment out</span></span>
<span>  <span class="co">#   this print() command.</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">weeklyOpioidPatterns_df</span>, by <span class="op">=</span> <span class="st">"who"</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 9 × 5</span></span></span>
<span><span class="co">#&gt;     who startWeek randWeek1 randWeek2 endWeek</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     4        -<span style="color: #BB0000;">4</span>         0        <span style="color: #BB0000;">NA</span>      24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span>    13        -<span style="color: #BB0000;">4</span>         0        <span style="color: #BB0000;">NA</span>      24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span>    17        -<span style="color: #BB0000;">6</span>         0        <span style="color: #BB0000;">NA</span>      23</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span>   163        -<span style="color: #BB0000;">5</span>         0        <span style="color: #BB0000;">NA</span>      24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span>   210        -<span style="color: #BB0000;">5</span>         0        <span style="color: #BB0000;">NA</span>      24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span>   233        -<span style="color: #BB0000;">4</span>         0        <span style="color: #BB0000;">NA</span>      24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span>   242        -<span style="color: #BB0000;">5</span>         0        <span style="color: #BB0000;">NA</span>      23</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span>  <span style="text-decoration: underline;">1</span>103        -<span style="color: #BB0000;">4</span>         0        10      34</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">9</span>  <span style="text-decoration: underline;">2</span>089        -<span style="color: #BB0000;">4</span>         0        <span style="color: #BB0000;">NA</span>      24</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="symbolically-summarize-non-randomized-participants-uds-by-study-week">Symbolically Summarize Non-Randomized Participants UDS by Study
Week<a class="anchor" aria-label="anchor" href="#symbolically-summarize-non-randomized-participants-uds-by-study-week"></a>
</h3>
<p>There are some strange cases where non-randomized participants also
submitted UDS samples during the clinical trial. We will also create
quinary words for these participants, but note that most of the UDS
results will be missing (symbolized by “o”).</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nonRandUDS_df</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">backbone_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">who</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">notRandomized_int</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">uds</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="co"># MarkUse() requires a "source" column</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>source <span class="op">=</span> <span class="st">"UDS"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/MarkUse.html">MarkUse</a></span><span class="op">(</span></span>
<span>        targetDrugs_char <span class="op">=</span> <span class="va">nonStudyOpioids_ls</span><span class="op">$</span><span class="va">`Not treated`</span>,</span>
<span>        drugs_df <span class="op">=</span> <span class="va">.</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    udsOpioid <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">when</span><span class="op">)</span> <span class="op">~</span> <span class="cn">TRUE</span>,</span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">when</span><span class="op">)</span> <span class="op">~</span> <span class="cn">NA</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">who</span>, <span class="va">when</span>, <span class="va">udsOpioid</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Uneccessary here, but some UDS records are duplicated</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/distinct.html" class="external-link">distinct</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>Although not present in this small data example, there are positive
UDS events among the non-randomized. We then construct a “study week”
ticker to mark such weekly UDS results.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">timelineNonRandUDS_df</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">backbone_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">who</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">notRandomized_int</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">nonRandUDS_df</span>, by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"who"</span>, <span class="st">"when"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Because this week moves off of the consent date, there is no reason to add</span></span>
<span>  <span class="co">#   a `(week - 1)` adjustment</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>studyWeek <span class="op">=</span> <span class="va">when</span> <span class="op"><a href="https://rdrr.io/r/base/Arithmetic.html" class="external-link">%/%</a></span> <span class="fl">7</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">who</span>, <span class="va">studyWeek</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>        posUDS  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">udsOpioid</span> <span class="op">==</span> <span class="fl">1</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">0</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<p>For these participants who were not randomized at all, they will only
have “Phase I” missing values.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weeklyNonRandPatterns_df</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">timelineNonRandUDS_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    udsStatus <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="co"># If they are positive, they are positive</span></span>
<span>      <span class="va">posUDS</span> <span class="op">~</span> <span class="st">"+"</span>,</span>
<span>      <span class="co"># If they aren't positive and it's after the consent week, they are</span></span>
<span>      <span class="co">#   missing (because they weren't randomized)</span></span>
<span>      <span class="op">!</span><span class="va">posUDS</span> <span class="op">&amp;</span> <span class="va">studyWeek</span> <span class="op">&gt;=</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"o"</span>,</span>
<span>      <span class="co"># If they aren't positive and it's on or before the consent week, then</span></span>
<span>      <span class="co">#   leave it blank (pre-study)</span></span>
<span>      <span class="op">!</span><span class="va">posUDS</span> <span class="op">&amp;</span> <span class="va">studyWeek</span> <span class="op">&lt;</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"_"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    phase <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">studyWeek</span> <span class="op">&lt;</span>  <span class="fl">1</span> <span class="op">~</span> <span class="st">"Baseline"</span>,</span>
<span>      <span class="va">studyWeek</span> <span class="op">&gt;=</span> <span class="fl">1</span> <span class="op">~</span> <span class="st">"Phase_1"</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="co"># Again, this print is unecessary, but here it make clear what we are doing</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">who</span>, <span class="va">phase</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    usePattern <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">udsStatus</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html" class="external-link">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="st">"phase"</span>, values_from <span class="op">=</span> <span class="st">"usePattern"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">ungroup</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 20 × 5</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># Groups:   who [1]</span></span></span>
<span><span class="co">#&gt;      who studyWeek posUDS udsStatus phase   </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1        -<span style="color: #BB0000;">4</span> FALSE  _         Baseline</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     1        -<span style="color: #BB0000;">3</span> FALSE  _         Baseline</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>     1        -<span style="color: #BB0000;">2</span> FALSE  _         Baseline</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>     1        -<span style="color: #BB0000;">1</span> FALSE  _         Baseline</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>     1         0 FALSE  _         Baseline</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>     1         1 FALSE  o         Phase_1 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>     1         2 FALSE  o         Phase_1 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>     1         3 FALSE  o         Phase_1 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>     1         4 FALSE  o         Phase_1 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>     1         5 FALSE  o         Phase_1 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span>     1         6 FALSE  o         Phase_1 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span>     1         7 FALSE  o         Phase_1 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span>     1         8 FALSE  o         Phase_1 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span>     1         9 FALSE  o         Phase_1 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span>     1        10 FALSE  o         Phase_1 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span>     1        11 FALSE  o         Phase_1 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span>     1        12 FALSE  o         Phase_1 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span>     1        13 FALSE  o         Phase_1 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span>     1        14 FALSE  o         Phase_1 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span>     1        15 FALSE  o         Phase_1</span></span>
<span></span>
<span><span class="va">weeklyNonRandPatterns_df</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 3</span></span></span>
<span><span class="co">#&gt;     who Baseline Phase_1        </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span>     1 _____    ooooooooooooooo</span></span></code></pre></div>
<p>Finally, we add in the start and end weeks for these two phases.</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">derived_weeklyOpioidPatternNonRand</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">timelineNonRandUDS_df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">who</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span></span>
<span>    startWeek  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">studyWeek</span><span class="op">)</span>,</span>
<span>    randWeek1  <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>    randWeek2  <span class="op">=</span> <span class="cn">NA_real_</span>,</span>
<span>    endWeek    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">studyWeek</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">left_join</a></span><span class="op">(</span><span class="va">weeklyNonRandPatterns_df</span>, by <span class="op">=</span> <span class="st">"who"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="final-product">Final Product<a class="anchor" aria-label="anchor" href="#final-product"></a>
</h3>
<p>At the end of this very long process, we have this:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">derived_weeklyOpioidPattern</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">derived_weeklyOpioidPatternRand</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind_rows.html" class="external-link">bind_rows</a></span><span class="op">(</span><span class="va">derived_weeklyOpioidPatternNonRand</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">who</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/replace_na.html" class="external-link">replace_na</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Phase_2 <span class="op">=</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">derived_weeklyOpioidPattern</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 8</span></span></span>
<span><span class="co">#&gt;      who startWeek randWeek1 randWeek2 endWeek Baseline Phase_1          Phase_2</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span>     1        -<span style="color: #BB0000;">4</span>        <span style="color: #BB0000;">NA</span>        <span style="color: #BB0000;">NA</span>      15 _____    ooooooooooooooo  <span style="color: #949494;">""</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span>     4        -<span style="color: #BB0000;">4</span>         0        <span style="color: #BB0000;">NA</span>      24 ____-    ---------------… <span style="color: #949494;">""</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span>    13        -<span style="color: #BB0000;">4</span>         0        <span style="color: #BB0000;">NA</span>      24 ____*    -------o---o-oo… <span style="color: #949494;">""</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span>    17        -<span style="color: #BB0000;">6</span>         0        <span style="color: #BB0000;">NA</span>      23 _____+-  o-++*++++++-+++… <span style="color: #949494;">""</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span>   163        -<span style="color: #BB0000;">5</span>         0        <span style="color: #BB0000;">NA</span>      24 _____*   ----oo---o--o*-… <span style="color: #949494;">""</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span>   210        -<span style="color: #BB0000;">5</span>         0        <span style="color: #BB0000;">NA</span>      24 _____*   ++++++++-+++---… <span style="color: #949494;">""</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span>   233        -<span style="color: #BB0000;">4</span>         0        <span style="color: #BB0000;">NA</span>      24 ____*    +++++++++++++++… <span style="color: #949494;">""</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span>   242        -<span style="color: #BB0000;">5</span>         0        <span style="color: #BB0000;">NA</span>      23 ____+_   ---------------… <span style="color: #949494;">""</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span>  <span style="text-decoration: underline;">1</span>103        -<span style="color: #BB0000;">4</span>         0        10      34 ____+    +o--oo--o        <span style="color: #949494;">"</span>*+-+-…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span>  <span style="text-decoration: underline;">2</span>089        -<span style="color: #BB0000;">4</span>         0        <span style="color: #BB0000;">NA</span>      24 ____*    ++++---+-------… <span style="color: #949494;">""</span></span></span></code></pre></div>
<hr>
<p></p>
</div>
</div>
<div class="section level2">
<h2 id="wrapping-up">Wrapping Up<a class="anchor" aria-label="anchor" href="#wrapping-up"></a>
</h2>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R version 4.3.2 (2023-10-31)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] stringr_1.5.0             tidyr_1.3.0              </span></span>
<span><span class="co">#&gt; [3] tibble_3.2.1              purrr_1.0.2              </span></span>
<span><span class="co">#&gt; [5] dplyr_1.1.3               public.ctn0094extra_1.0.3</span></span>
<span><span class="co">#&gt; [7] public.ctn0094data_1.0.6 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;  [1] jsonlite_1.8.7    compiler_4.3.2    tidyselect_1.2.0  jquerylib_0.1.4  </span></span>
<span><span class="co">#&gt;  [5] systemfonts_1.0.5 textshaping_0.3.7 yaml_2.3.7        fastmap_1.1.1    </span></span>
<span><span class="co">#&gt;  [9] R6_2.5.1          generics_0.1.3    knitr_1.45        desc_1.4.2       </span></span>
<span><span class="co">#&gt; [13] rprojroot_2.0.4   bslib_0.5.1       pillar_1.9.0      rlang_1.1.2      </span></span>
<span><span class="co">#&gt; [17] utf8_1.2.4        cachem_1.0.8      stringi_1.8.1     xfun_0.41        </span></span>
<span><span class="co">#&gt; [21] fs_1.6.3          sass_0.4.7        memoise_2.0.1     cli_3.6.1        </span></span>
<span><span class="co">#&gt; [25] withr_2.5.2       pkgdown_2.0.7     magrittr_2.0.3    digest_0.6.33    </span></span>
<span><span class="co">#&gt; [29] lifecycle_1.0.4   vctrs_0.6.4       evaluate_0.23     glue_1.6.2       </span></span>
<span><span class="co">#&gt; [33] ragg_1.2.6        fansi_1.0.5       rmarkdown_2.25    tools_4.3.2      </span></span>
<span><span class="co">#&gt; [37] pkgconfig_2.0.3   htmltools_0.5.7</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by <a href="https://gabriel.quarto.pub/home/" class="external-link">Gabriel Odom</a>, <a href="https://github.com/RaymondBalise" class="external-link">Raymond Balise</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
